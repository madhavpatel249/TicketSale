{"ast":null,"code":"import React,{useEffect,useState,useContext}from'react';import axios from'axios';import Navbar from'../common/Navbar';import{AuthContext}from'../../context/AuthContext';import{CalendarDays,MapPin,Ticket,User,AlertCircle}from'lucide-react';import Confetti from'react-confetti';import API_BASE_URL from'../../config/apiConfig';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Profile(){const{user,token}=useContext(AuthContext);const[tickets,setTickets]=useState([]);const[eventsMap,setEventsMap]=useState({});const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[showConfetti,setShowConfetti]=useState(false);useEffect(()=>{const fetchTickets=async()=>{try{const res=await axios.get(`${API_BASE_URL}/api/users/${user.id}/tickets`,{headers:{Authorization:`Bearer ${token}`}});const ticketsWithEvents=await Promise.all(res.data.map(async ticket=>{const eventRes=await axios.get(`${API_BASE_URL}/api/events/${ticket.eventId}`);return{...ticket,event:eventRes.data};}));setTickets(ticketsWithEvents);setLoading(false);}catch(error){console.error('Error fetching tickets:',error);setError('Failed to load tickets');setLoading(false);}};if(user&&token){fetchTickets();}},[user,token]);const groupTicketsByMonth=()=>{const groups={};tickets.forEach(ticket=>{const event=eventsMap[ticket.eventId];if(!event)return;const eventDate=new Date(event.date);const monthYear=eventDate.toLocaleString('default',{month:'long',year:'numeric'});if(!groups[monthYear])groups[monthYear]=[];groups[monthYear].push({ticket,event});});return groups;};const groupedTickets=groupTicketsByMonth();return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-lightGray pt-24 pb-12\",children:[/*#__PURE__*/_jsx(Navbar,{}),showConfetti&&/*#__PURE__*/_jsx(Confetti,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto px-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsxs(\"h2\",{className:\"text-3xl font-bold text-primary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(User,{size:24}),\"My Tickets\"]})}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-darkGray animate-fade-in\",children:\"Loading your tickets...\"}):error?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-warning bg-warning/10 p-3 rounded-lg animate-fade-in\",children:[/*#__PURE__*/_jsx(AlertCircle,{size:18}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:error})]}):tickets.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-darkGray animate-fade-in\",children:\"You haven't purchased any tickets yet.\"}):Object.entries(groupedTickets).map(_ref=>{let[monthYear,items]=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-10 animate-fade-in\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-primary mb-6\",children:monthYear}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\",children:items.map((_ref2,index)=>{let{ticket,event}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-40 bg-gray-100 rounded-lg overflow-hidden mb-4\",children:event.image?/*#__PURE__*/_jsx(\"img\",{src:event.image,alt:event.title,className:\"w-full h-full object-cover\",onError:e=>e.target.style.display='none'}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full bg-gray-200\"})}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold text-primary mb-3\",children:event.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-darkGray\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CalendarDays,{size:16}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:new Date(event.date).toLocaleDateString()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{size:16}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:event.location})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-secondary\",children:[/*#__PURE__*/_jsx(Ticket,{size:16}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium\",children:[ticket.type.toUpperCase(),\" Ticket\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 pt-4 border-t border-gray-100\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-darkGray\",children:[\"Purchased: \",new Date(ticket.purchasedAt).toLocaleDateString()]})})]},index);})})]},monthYear);})]})]});}export default Profile;","map":{"version":3,"names":["React","useEffect","useState","useContext","axios","Navbar","AuthContext","CalendarDays","MapPin","Ticket","User","AlertCircle","Confetti","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","Profile","user","token","tickets","setTickets","eventsMap","setEventsMap","loading","setLoading","error","setError","showConfetti","setShowConfetti","fetchTickets","res","get","id","headers","Authorization","ticketsWithEvents","Promise","all","data","map","ticket","eventRes","eventId","event","console","groupTicketsByMonth","groups","forEach","eventDate","Date","date","monthYear","toLocaleString","month","year","push","groupedTickets","className","children","size","length","Object","entries","_ref","items","_ref2","index","image","src","alt","title","onError","e","target","style","display","toLocaleDateString","location","type","toUpperCase","purchasedAt"],"sources":["/Users/madhavpatel/Desktop/Evently/TicketSale/frontend/src/components/auth/Profile.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport axios from 'axios';\nimport Navbar from '../common/Navbar';\nimport { AuthContext } from '../../context/AuthContext';\nimport { CalendarDays, MapPin, Ticket, User, AlertCircle } from 'lucide-react';\nimport Confetti from 'react-confetti';\nimport API_BASE_URL from '../../config/apiConfig';\n\nfunction Profile() {\n  const { user, token } = useContext(AuthContext);\n  const [tickets, setTickets] = useState([]);\n  const [eventsMap, setEventsMap] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [showConfetti, setShowConfetti] = useState(false);\n\n  useEffect(() => {\n    const fetchTickets = async () => {\n      try {\n        const res = await axios.get(`${API_BASE_URL}/api/users/${user.id}/tickets`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n\n        const ticketsWithEvents = await Promise.all(\n          res.data.map(async (ticket) => {\n            const eventRes = await axios.get(`${API_BASE_URL}/api/events/${ticket.eventId}`);\n            return {\n              ...ticket,\n              event: eventRes.data\n            };\n          })\n        );\n\n        setTickets(ticketsWithEvents);\n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching tickets:', error);\n        setError('Failed to load tickets');\n        setLoading(false);\n      }\n    };\n\n    if (user && token) {\n      fetchTickets();\n    }\n  }, [user, token]);\n\n  const groupTicketsByMonth = () => {\n    const groups = {};\n    tickets.forEach(ticket => {\n      const event = eventsMap[ticket.eventId];\n      if (!event) return;\n\n      const eventDate = new Date(event.date);\n      const monthYear = eventDate.toLocaleString('default', { month: 'long', year: 'numeric' });\n\n      if (!groups[monthYear]) groups[monthYear] = [];\n      groups[monthYear].push({ ticket, event });\n    });\n    return groups;\n  };\n\n  const groupedTickets = groupTicketsByMonth();\n\n  return (\n    <div className=\"min-h-screen bg-lightGray pt-24 pb-12\">\n      <Navbar />\n      {showConfetti && <Confetti />}\n      <div className=\"max-w-6xl mx-auto px-4\">\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold text-primary flex items-center gap-2\">\n            <User size={24} />\n            My Tickets\n          </h2>\n        </div>\n\n        {loading ? (\n          <div className=\"text-center text-darkGray animate-fade-in\">\n            Loading your tickets...\n          </div>\n        ) : error ? (\n          <div className=\"flex items-center gap-2 text-warning bg-warning/10 p-3 rounded-lg animate-fade-in\">\n            <AlertCircle size={18} />\n            <p className=\"text-sm\">{error}</p>\n          </div>\n        ) : tickets.length === 0 ? (\n          <div className=\"text-center text-darkGray animate-fade-in\">\n            You haven't purchased any tickets yet.\n          </div>\n        ) : (\n          Object.entries(groupedTickets).map(([monthYear, items]) => (\n            <div key={monthYear} className=\"mb-10 animate-fade-in\">\n              <h3 className=\"text-xl font-semibold text-primary mb-6\">{monthYear}</h3>\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {items.map(({ ticket, event }, index) => (\n                  <div\n                    key={index}\n                    className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200\"\n                  >\n                    <div className=\"w-full h-40 bg-gray-100 rounded-lg overflow-hidden mb-4\">\n                      {event.image ? (\n                        <img\n                          src={event.image}\n                          alt={event.title}\n                          className=\"w-full h-full object-cover\"\n                          onError={(e) => (e.target.style.display = 'none')}\n                        />\n                      ) : (\n                        <div className=\"w-full h-full bg-gray-200\"></div>\n                      )}\n                    </div>\n\n                    <h4 className=\"text-lg font-semibold text-primary mb-3\">{event.title}</h4>\n                    \n                    <div className=\"space-y-2 text-darkGray\">\n                      <div className=\"flex items-center gap-2\">\n                        <CalendarDays size={16} />\n                        <span className=\"text-sm\">{new Date(event.date).toLocaleDateString()}</span>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <MapPin size={16} />\n                        <span className=\"text-sm\">{event.location}</span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-secondary\">\n                        <Ticket size={16} />\n                        <span className=\"text-sm font-medium\">{ticket.type.toUpperCase()} Ticket</span>\n                      </div>\n                    </div>\n\n                    <div className=\"mt-4 pt-4 border-t border-gray-100\">\n                      <p className=\"text-xs text-darkGray\">\n                        Purchased: {new Date(ticket.purchasedAt).toLocaleDateString()}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Profile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}